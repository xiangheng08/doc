# æ­£åˆ™è¡¨è¾¾å¼

æ­£åˆ™è¡¨è¾¾å¼ï¼ˆRegular Expressionï¼‰æ˜¯ä¸€ç§ç”¨æ¥åŒ¹é…å­—ç¬¦ä¸²çš„æ¨¡å¼ã€‚åœ¨ JavaScript ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥æ‰§è¡Œæ¨¡å¼åŒ¹é…å’Œæœç´¢æ›¿æ¢ç­‰æ“ä½œã€‚

## ç‰¹æ®Šå­—ç¬¦

### æ–­è¨€

æ–­è¨€è¡¨ç¤ºåŒ¹é…å‘ç”Ÿçš„æ¡ä»¶ï¼Œå®ƒä»¬ä¸å®é™…æ¶ˆè€—å­—ç¬¦ã€‚

| å­—ç¬¦ | å«ä¹‰ |
| ---- | ---- |
| `^` | åŒ¹é…è¾“å…¥çš„å¼€å§‹ã€‚åœ¨å¤šè¡Œæ¨¡å¼ä¸‹ï¼Œä¹Ÿä¼šåŒ¹é…æ¢è¡Œç¬¦åçš„ä½ç½®ã€‚ |
| `$` | åŒ¹é…è¾“å…¥çš„ç»“æŸã€‚åœ¨å¤šè¡Œæ¨¡å¼ä¸‹ï¼Œä¹Ÿä¼šåŒ¹é…æ¢è¡Œç¬¦å‰çš„ä½ç½®ã€‚ |
| `\b` | åŒ¹é…å•è¯è¾¹ç•Œï¼Œå³å•è¯å­—ç¬¦ä¸éå•è¯å­—ç¬¦ä¹‹é—´çš„ä½ç½®ã€‚ |
| `\B` | åŒ¹é…éå•è¯è¾¹ç•Œã€‚ |
| `x(?=y)` | æ­£å‘å…ˆè¡Œæ–­è¨€ï¼ŒåŒ¹é… `x` ä»…å½“ `x` åé¢è·Ÿç€ `y`ã€‚ |
| `x(?!y)` | è´Ÿå‘å…ˆè¡Œæ–­è¨€ï¼ŒåŒ¹é… `x` ä»…å½“ `x` åé¢ä¸è·Ÿç€ `y`ã€‚ |
| `(?<=y)x` | æ­£å‘åè¡Œæ–­è¨€ï¼ŒåŒ¹é… `x` ä»…å½“ `x` å‰é¢æ˜¯ `y`ã€‚ |
| `(?<!y)x` | è´Ÿå‘åè¡Œæ–­è¨€ï¼ŒåŒ¹é… `x` ä»…å½“ `x` å‰é¢ä¸æ˜¯ `y`ã€‚ |

### å­—ç¬¦ç±»

å­—ç¬¦ç±»ç”¨äºåŒºåˆ†ä¸åŒç±»å‹çš„å­—ç¬¦ã€‚

| å­—ç¬¦ | å«ä¹‰ |
| ---- | ---- |
| `.` | é»˜è®¤åŒ¹é…é™¤æ¢è¡Œç¬¦ä¹‹å¤–çš„ä»»ä½•å•ä¸ªå­—ç¬¦ã€‚ |
| `\d` | åŒ¹é…ä¸€ä¸ªæ•°å­—å­—ç¬¦ï¼Œç­‰ä»·äº `[0-9]`ã€‚ |
| `\D` | åŒ¹é…ä¸€ä¸ªéæ•°å­—å­—ç¬¦ï¼Œç­‰ä»·äº `[^0-9]`ã€‚ |
| `\w` | åŒ¹é…ä¸€ä¸ªå•è¯å­—ç¬¦ï¼ˆå­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼‰ï¼Œç­‰ä»·äº `[A-Za-z0-9_]`ã€‚ |
| `\W` | åŒ¹é…ä¸€ä¸ªéå•è¯å­—ç¬¦ï¼Œç­‰ä»·äº `[^A-Za-z0-9_]`ã€‚ |
| `\s` | åŒ¹é…ä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ã€‚ |
| `\S` | åŒ¹é…ä¸€ä¸ªéç©ºç™½å­—ç¬¦ã€‚ |
| `[\b]` | åŒ¹é…ä¸€ä¸ªé€€æ ¼ç¬¦ï¼ˆç‰¹æ®Šæƒ…å†µï¼‰ã€‚ |
| `[xyz]` | å­—ç¬¦é›†åˆï¼ŒåŒ¹é…æ–¹æ‹¬å·ä¸­çš„ä»»æ„å­—ç¬¦ã€‚ |
| `[^xyz]` | åå‘å­—ç¬¦é›†åˆï¼ŒåŒ¹é…é™¤äº†æ–¹æ‹¬å·ä¸­å­—ç¬¦ä¹‹å¤–çš„ä»»æ„å­—ç¬¦ã€‚ |
| `[x-y]` | å­—ç¬¦èŒƒå›´ï¼ŒåŒ¹é…æŒ‡å®šèŒƒå›´å†…çš„ä»»æ„å­—ç¬¦ã€‚ |

### ç»„å’Œåå‘å¼•ç”¨

| å­—ç¬¦ | å«ä¹‰ |
| ---- | ---- |
| `(x)` | åŒ¹é… `x` å¹¶æ•è·åŒ¹é…é¡¹ï¼Œç§°ä¸ºæ•è·ç»„ã€‚ |
| `(?<Name>x)` | å‘½åæ•è·ç»„ã€‚ |
| `(?:x)` | åŒ¹é… `x` ä½†ä¸æ•è·åŒ¹é…é¡¹ï¼Œç§°ä¸ºéæ•è·ç»„ã€‚ |
| `\n` | åå‘å¼•ç”¨ï¼ŒåŒ¹é…ç¬¬ n ä¸ªæ•è·ç»„åŒ¹é…çš„æ–‡æœ¬ã€‚ |
| `\k<Name>` | åå‘å¼•ç”¨ï¼ŒåŒ¹é…æŒ‡å®šåç§°çš„æ•è·ç»„åŒ¹é…çš„æ–‡æœ¬ã€‚ |

### é‡è¯

é‡è¯æŒ‡å®šå‰é¢çš„å­—ç¬¦æˆ–ç»„åº”è¯¥åŒ¹é…çš„æ¬¡æ•°ã€‚

| å­—ç¬¦ | å«ä¹‰ |
| ---- | ---- |
| `x*` | åŒ¹é…å‰é¢çš„æ¨¡å¼ `x` 0 æ¬¡æˆ–å¤šæ¬¡ã€‚ |
| `x+` | åŒ¹é…å‰é¢çš„æ¨¡å¼ `x` 1 æ¬¡æˆ–å¤šæ¬¡ã€‚ |
| `x?` | åŒ¹é…å‰é¢çš„æ¨¡å¼ `x` 0 æ¬¡æˆ– 1 æ¬¡ã€‚ |
| `x{n}` | åŒ¹é…å‰é¢çš„æ¨¡å¼ `x` æ°å¥½ `n` æ¬¡ã€‚ |
| `x{n,}` | åŒ¹é…å‰é¢çš„æ¨¡å¼ `x` è‡³å°‘ `n` æ¬¡ã€‚ |
| `x{n,m}` | åŒ¹é…å‰é¢çš„æ¨¡å¼ `x` è‡³å°‘ `n` æ¬¡ï¼Œè‡³å¤š `m` æ¬¡ã€‚ |
| `x*?` | éè´ªå©ªåŒ¹é…å‰é¢çš„æ¨¡å¼ `x` 0 æ¬¡æˆ–å¤šæ¬¡ã€‚ |
| `x+?` | éè´ªå©ªåŒ¹é…å‰é¢çš„æ¨¡å¼ `x` 1 æ¬¡æˆ–å¤šæ¬¡ã€‚ |
| `x??` | éè´ªå©ªåŒ¹é…å‰é¢çš„æ¨¡å¼ `x` 0 æ¬¡æˆ– 1 æ¬¡ã€‚ |

### å…¶ä»–ç‰¹æ®Šå­—ç¬¦

| å­—ç¬¦ | å«ä¹‰ |
| ---- | ---- |
| `x\|y` | åŒ¹é… `x` æˆ– `y`ã€‚ |
| `\` | è½¬ä¹‰ç¬¦ï¼Œç”¨äºè½¬ä¹‰åé¢çš„ç‰¹æ®Šå­—ç¬¦ï¼Œä½¿å…¶æŒ‰å­—é¢æ„æ€åŒ¹é…ã€‚ |


## æ ‡å¿— {#flags}

æ­£åˆ™è¡¨è¾¾å¼æ ‡å¿—ç”¨äºæ”¹å˜æ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é…è¡Œä¸ºã€‚

### `g` (å…¨å±€) {#g-flag}

æŸ¥æ‰¾æ‰€æœ‰åŒ¹é…é¡¹ï¼Œè€Œä¸æ˜¯åœ¨ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ååœæ­¢ã€‚

```js
const regex = /test/g;
const str = 'test test test';
console.log(str.match(regex)); // ["test", "test", "test"]
```

### `i` (å¿½ç•¥å¤§å°å†™) {#i-flag}

æ‰§è¡Œä¸åŒºåˆ†å¤§å°å†™çš„åŒ¹é…ã€‚

```js
const regex = /test/i;
console.log(regex.test('TEST')); // true
console.log(regex.test('Test')); // true
```

### `m` (å¤šè¡Œ) {#m-flag}

æ‰§è¡Œå¤šè¡ŒåŒ¹é…ï¼Œæ”¹å˜ `^` å’Œ `$` çš„è¡Œä¸ºï¼Œä½¿å®ƒä»¬åˆ†åˆ«åŒ¹é…è¡Œçš„å¼€å§‹å’Œç»“æŸï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—ç¬¦ä¸²çš„å¼€å§‹å’Œç»“æŸã€‚

```js
const regex = /^test/m;
const str = 'test\nanothertest\ntest';
console.log(str.match(regex)); // ["test", "test"]
```

### `s` (dotAll) {#s-flag}

å…è®¸ `.` åŒ¹é…æ¢è¡Œç¬¦ã€‚

```js
const regex = /test.*end/s;
const str = 'test\nmiddle\nend';
console.log(regex.test(str)); // true
```

### `u` (Unicode) {#u-flag}

ä½¿ç”¨ Unicode ç ç‚¹è¿›è¡ŒåŒ¹é…ï¼Œæ”¯æŒ Unicode å­—ç¬¦å¤„ç†ã€‚

```js
const regex = /\u{1F600}/u;
const str = 'ğŸ˜€';
console.log(regex.test(str)); // true
```

### `y` (sticky) {#y-flag}

æ‰§è¡Œ"sticky"åŒ¹é…ï¼Œä» [lastIndex](./stdlib/regexp.md#RegExp.prototype.lastIndex) æŒ‡å®šçš„ä½ç½®å¼€å§‹ã€‚

```js
const str = 'hello world';
const regex = /world/y;
regex.lastIndex = 6;
console.log(regex.test(str)); // true

regex.lastIndex = 0;
console.log(regex.test(str)); // false
```

## é«˜çº§ç‰¹æ€§

### ç¯è§†ï¼ˆLookahead å’Œ Lookbehindï¼‰

ç¯è§†æ˜¯ä¸€ç§é›¶å®½åº¦æ–­è¨€ï¼Œç”¨äºæ£€æŸ¥æŸä¸ªä½ç½®å‰åæ˜¯å¦ç¬¦åˆç‰¹å®šæ¨¡å¼ï¼Œä½†ä¸æ¶ˆè€—å­—ç¬¦ã€‚

#### å…ˆè¡Œæ–­è¨€ï¼ˆLookaheadï¼‰

å…ˆè¡Œæ–­è¨€æ£€æŸ¥æŸä¸ªæ¨¡å¼åé¢æ˜¯å¦è·Ÿç€å¦ä¸€ä¸ªæ¨¡å¼ã€‚

```js
// æ­£å‘å…ˆè¡Œæ–­è¨€ - åŒ¹é…åé¢è·Ÿç€æ•°å­—çš„å•è¯
const lookaheadRegex = /\w+(?=\d)/g;
const str1 = 'word1 word2 another3 word';
console.log(str1.match(lookaheadRegex)); // ["word", "word", "another"]

// è´Ÿå‘å…ˆè¡Œæ–­è¨€ - åŒ¹é…åé¢ä¸è·Ÿæ•°å­—çš„å•è¯
const negativeLookaheadRegex = /\w+(?!\d)/g;
const str2 = 'word1 word2 another3 word';
console.log(str2.match(negativeLookaheadRegex)); // ["word", "word", "another", "word"]
```

#### åè¡Œæ–­è¨€ï¼ˆLookbehindï¼‰

åè¡Œæ–­è¨€æ£€æŸ¥æŸä¸ªæ¨¡å¼å‰é¢æ˜¯å¦æœ‰å¦ä¸€ä¸ªæ¨¡å¼ã€‚

```js
// æ­£å‘åè¡Œæ–­è¨€ - åŒ¹é…å‰é¢æœ‰ç¾å…ƒç¬¦å·çš„æ•°å­—
const lookbehindRegex = /(?<=\$)\d+/g;
const str3 = 'ä»·æ ¼æ˜¯$100å’Œ$200';
console.log(str3.match(lookbehindRegex)); // ["100", "200"]

// è´Ÿå‘åè¡Œæ–­è¨€ - åŒ¹é…å‰é¢æ²¡æœ‰ç¾å…ƒç¬¦å·çš„æ•°å­—
const negativeLookbehindRegex = /(?<!\$)\d+/g;
const str4 = 'ä»·æ ¼æ˜¯$100å’Œ200';
console.log(str4.match(negativeLookbehindRegex)); // ["200"]
```

### å‘½åæ•è·ç»„

å‘½åæ•è·ç»„å…è®¸ä¸ºæ•è·ç»„æŒ‡å®šåç§°ï¼Œæé«˜ä»£ç å¯è¯»æ€§ã€‚

```js
const dateRegex = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/;
const dateStr = '2023-10-05';
const match = dateStr.match(dateRegex);

if (match) {
  console.log(match.groups.year);  // "2023"
  console.log(match.groups.month); // "10"
  console.log(match.groups.day);   // "05"
  
  // åœ¨ replace ä¸­ä½¿ç”¨å‘½åæ•è·ç»„
  const formatted = dateStr.replace(dateRegex, '$<day>.$<month>.$<year>');
  console.log(formatted); // "05.10.2023"
}
```

### éè´ªå©ªåŒ¹é…

é»˜è®¤æƒ…å†µä¸‹ï¼Œé‡è¯æ˜¯è´ªå©ªçš„ï¼Œä¼šå°½å¯èƒ½å¤šåœ°åŒ¹é…å­—ç¬¦ã€‚ä½¿ç”¨ `?` å¯ä»¥å¯ç”¨éè´ªå©ªåŒ¹é…ï¼š

```js
const str = '<p>æ®µè½1</p><p>æ®µè½2</p>';
const greedy = /<p>.*<\/p>/g;
const nonGreedy = /<p>.*?<\/p>/g;

console.log(str.match(greedy));     // ["<p>æ®µè½1</p><p>æ®µè½2</p>"]
console.log(str.match(nonGreedy));  // ["<p>æ®µè½1</p>", "<p>æ®µè½2</p>"]
```
## ä½¿ç”¨æ¡ˆä¾‹

### `exec` + `g` æ ‡å¿—æœç´¢æ•´ä¸ªå­—ç¬¦ä¸²

```js
// æœç´¢æ‰€æœ‰åŒ¹é…é¡¹
const text = "abc123def456ghi789";
const regex = /\d+/g;  // åŒ¹é…æ•°å­—ï¼Œä½¿ç”¨å…¨å±€æ ‡å¿—
let match;

while ((match = regex.exec(text)) !== null) {
    console.log(`æ‰¾åˆ°åŒ¹é…: ${match[0]}ï¼Œä½ç½®: ${match.index}`);
}

// è¾“å‡º:
// æ‰¾åˆ°åŒ¹é…: 123ï¼Œä½ç½®: 3
// æ‰¾åˆ°åŒ¹é…: 456ï¼Œä½ç½®: 9
// æ‰¾åˆ°åŒ¹é…: 789ï¼Œä½ç½®: 15
```

å¦‚æœä¸æ­¢æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œéœ€è¦å°† `regex.lastIndex` è®¾ç½®ä¸º 0ï¼Œä»¥ä¾¿æ¯æ¬¡åŒ¹é…ä»å­—ç¬¦ä¸²çš„å¼€å¤´å¼€å§‹ã€‚

```js
// é‡ç½® lastIndexï¼Œå»ºè®®åœ¨æ¯æ¬¡æœç´¢å‰é‡ç½®
regex.lastIndex = 0;
```

> æ³¨æ„ï¼šå¦‚æœæ²¡æœ‰ `g` æ ‡å¿—ï¼Œ`lastIndex` æ˜¯æ— æ•ˆçš„ï¼Œå§‹ç»ˆä¸º 0ï¼Œ`exec` æ–¹æ³•ä¹Ÿå°†å§‹ç»ˆè¿”å›ç¬¬ä¸€ä¸ªåŒ¹é…é¡¹ã€‚

## å¸¸ç”¨æ­£åˆ™è¡¨è¾¾å¼

[ç‚¹å‡»æŸ¥çœ‹](./regexes)

## æ€§èƒ½æç¤º

1. å°½å¯èƒ½ä½¿ç”¨å­—é¢é‡è¯­æ³•åˆ›å»ºæ­£åˆ™è¡¨è¾¾å¼ï¼Œè€Œä¸æ˜¯æ„é€ å‡½æ•°
2. é¿å…åœ¨å¾ªç¯ä¸­é‡å¤åˆ›å»ºç›¸åŒçš„æ­£åˆ™è¡¨è¾¾å¼
3. å¯¹äºå¤æ‚çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œè€ƒè™‘å°†å…¶åˆ†è§£ä¸ºå¤šä¸ªç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼
4. æ³¨æ„å›æº¯é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶
5. ä½¿ç”¨éæ•è·ç»„ `(?:...)` å¦‚æœä¸éœ€è¦æ•è·åŒ¹é…çš„å†…å®¹

```js
// æ¨èï¼šå¤ç”¨æ­£åˆ™è¡¨è¾¾å¼
const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

function validateEmail(email) {
  return emailRegex.test(email);
}

// ä¸æ¨èï¼šæ¯æ¬¡è°ƒç”¨éƒ½åˆ›å»ºæ–°çš„æ­£åˆ™è¡¨è¾¾å¼
function validateEmail(email) {
  return /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(email);
}
