---
outline: 2
---

# HTTP 版本演进

HTTP（HyperText Transfer Protocol）是万维网数据通信的基础。自诞生以来，HTTP 协议经历了多个版本的迭代和发展，每个版本都在性能、安全性和功能性方面有所提升。

## HTTP/0.9 - 第一个版本

HTTP/0.9 是 HTTP 协议的第一个版本，于 1991 年发布。这是最简单的 HTTP 协议版本：

### 特点：
- 只支持 GET 方法
- 没有请求头和响应头概念
- 只能传输 HTML 格式文件
- 每次请求后连接立即关闭
- 没有状态码或错误处理机制

### 示例请求：
```
GET /index.html
```

由于功能极其有限，HTTP/0.9 很快就无法满足日益增长的网络需求。

## HTTP/1.0 - 扩展协议

HTTP/1.0 于 1996 年发布为正式标准（RFC 1945），相比 HTTP/0.9 做出了重大改进：

### 主要改进：
- 引入了请求头和响应头
- 支持多种 HTTP 方法：GET、POST、HEAD
- 支持多种内容格式，不仅仅是 HTML
- 添加了状态码机制
- 引入了 Content-Type 头来标识内容类型
- 支持字符集、编码等信息

### 示例请求：
```
GET /index.html HTTP/1.0
Host: www.example.com
User-Agent: Mozilla/5.0
Accept: */*
```

### 示例响应：
```
HTTP/1.0 200 OK
Content-Type: text/html
Server: Apache/1.0

<html>...</html>
```

尽管有了这些改进，HTTP/1.0 仍存在性能问题：每次请求都需要建立新的 TCP 连接，这导致了较高的延迟和资源消耗。

## HTTP/1.1 - 性能优化

HTTP/1.1 于 1997 年发布（RFC 2068，后来更新为 RFC 2616），是最重要的 HTTP 版本之一，解决了 HTTP/1.0 的许多限制：

### 相比 HTTP/1.0 的主要改进：
- 默认启用持久连接（Keep-Alive），允许在一个 TCP 连接上传输多个请求/响应
- 引入了管道化（pipelining），客户端可以在不等待前一个响应的情况下发送多个请求
- 添加了 Host 请求头，使得一台服务器可以托管多个域名（虚拟主机）
- 引入了缓存控制机制，包括 ETag、Cache-Control 等头部
- 增加了更多的状态码
- 支持分块传输编码（Chunked Transfer Encoding）
- 新增了许多请求方法：PUT、DELETE、OPTIONS、TRACE 等

HTTP/1.1 成为了互联网上使用最广泛的 HTTP 版本，至今仍在大量使用。

## HTTP/2 - 二进制协议

HTTP/2 于 2015 年标准化（RFC 7540），基于 Google 的 SPDY 协议开发，是对 HTTP/1.1 的重大升级：

### 相比 HTTP/1.1 的主要改进：
- 采用二进制分帧层，不再是纯文本协议
- 实现多路复用，在同一个连接上并行处理多个请求/响应，消除了队头阻塞问题
- 支持服务器推送，服务器可以主动向客户端发送资源
- 头部压缩（HPACK），减少冗余数据传输
- 强制使用 TLS（虽然规范未强制，但主流浏览器都只在 HTTPS 上实现 HTTP/2）

HTTP/2 显著提升了网页加载速度和服务器资源利用效率。

## HTTP/3 - 基于 QUIC 协议

HTTP/3 是最新的 HTTP 版本，于 2022 年正式标准化（RFC 9114），最大的变化是底层传输协议从 TCP 切换到了 QUIC：

### 相比 HTTP/2 的主要改进：
- 使用基于 UDP 的 QUIC 协议作为传输层，减少了连接建立延迟
- 内置加密，不需要额外的 TLS 握手过程
- 更好的拥塞控制和流量控制机制
- 连接迁移能力，当客户端 IP 地址发生变化时（如从 WiFi 切换到移动网络）可以保持连接
- 更细粒度的流控制，进一步改善多路复用效果

## 当前主要使用的 HTTP 版本

目前互联网上的 HTTP 使用情况大致如下：

1. **HTTP/1.1** - 仍然广泛使用，特别是在老旧系统和一些简单应用中
2. **HTTP/2** - 在现代浏览器和网站中占主导地位
3. **HTTP/3** - 正在逐步推广，被越来越多的服务提供商和浏览器支持

根据统计，截至 2023 年，全球约 70% 的网站支持 HTTP/2，约 25% 的网站支持 HTTP/3。HTTP/1.1 虽然仍有大量使用，但由于其性能限制，正在逐渐被更先进的版本替代。

## 浏览器如何确定 HTTP 版本

浏览器在发起 HTTP 请求时，会通过以下方式确定使用哪个 HTTP 版本：

### 1. 协商机制
- 浏览器在建立连接时会与服务器协商可支持的最高 HTTP 版本
- 服务器返回它支持的最佳版本

### 2. TLS ALPN 扩展
- 对于 HTTPS 连接，使用 TLS 的 ALPN（Application-Layer Protocol Negotiation）扩展来协商应用层协议版本
- 客户端在 TLS 握手中发送支持的协议列表（如 h3, h2, http/1.1）
- 服务器选择最佳匹配并通知客户端

### 3. 明文连接的版本协商
- 对于 HTTP 明文连接，通常默认使用 HTTP/1.1
- 如果需要更高版本，需要通过 Upgrade 头进行协议升级

### 4. 浏览器支持情况
不同浏览器对 HTTP 版本的支持情况：
- 所有现代浏览器都支持 HTTP/1.1
- 主流浏览器（Chrome、Firefox、Safari、Edge）均支持 HTTP/2
- HTTP/3 的支持也在不断完善，Chrome、Firefox 和 Edge 都已支持

### 5. 影响因素
浏览器选择 HTTP 版本时考虑的因素：
- 服务器支持的协议版本
- 是否通过 HTTPS 连接（HTTP/2 和 HTTP/3 通常需要 HTTPS）
- 网络环境和客户端配置
- 浏览器自身的实现和支持情况

总的来说，现代浏览器会优先尝试使用更高版本的 HTTP 协议以获得更好的性能，同时向下兼容旧版本以确保连接成功。
